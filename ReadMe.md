## Участники
* Хураськин Петр Алексеевич - 5130904/10105
* Важенина Елизавета Павловна - 5130904/10105
* Хураськина Виктория Александровна - 5130904/10104
* Чешковский Алексей Андреевич - 5130904/10104
* Митьков Егор Максимович - 5130904/10104

## Решаемая проблема
Проект решает проблему обеспечения безопасной и свободной платформы для обмена контентом, <br/>
позволяя пользователям загружать фото без ограничений по количеству и просматривать ленту друзей. <br/>
Платформа поддерживает общение под постами, добавление ссылок на внешние ресурсы и просмотр ссылок в виде сниппетов, <br/>
даже при недоступности внешних ресурсов.

## Бизнес требования 
* Размер фото ограничен
* Количество фото неограниченно
* Нет возможности общаться в чате, только под постом
* Необходимо, чтоб число друзей и последователей росло и потреблялось больше контента
* Связь с друзьями
* Возможность просмотра постов в виде сниппетов (ссылки на внешние ресурсы), как в телеграмме. Если внешний ресурс недоступен, у пользователя все равно должна быть возможность посмотреть превью.

## Функциональные(ФТ) и нефункциональные(НФТ) требования (из бизнес требований)
* НФТ - Размер фото ограничен 4 Мб.
* НФТ - Количество фото неограниченно.
* 1. ФТ - Возможность комментирования под публикациями (фото и видео).
  2. ФТ - Возможность отвечать на комментарии и на ответы к комментариям.
  3. ФТ - Возможность редактирования и удаления комментариев.
  4. ФТ - Возможность упоминания пользователей в комментариях.
  5. ФТ - Возможность управления приватностью комментариев (доступ только для друзей или публичный доступ).
  6. НФТ - Удаление и редактирование доступно в течение дня.
* ФТ - Должна быть отдельная лента рекомендаций, в которой пользователю предлагается контент схожий с тем, что его интересует.
* ФТ - Должна существовать система рекомендаций
* 1. ФТ - Добавление ссылок на внешние ресурсы: Пользователи должны иметь возможность добавлять ссылки на внешние ресурсы к фотографиям в системе.
  2. ФТ - Система должна предоставлять возможность просмотра ссылки (предпросмотра) в виде сниппетов, аналогично функционалу в приложении Telegram.
  3. ФТ - Даже при низком разрешении, система должна отображать снипет в виде превью.
  4. ФТ - При недоступности внешнего ресурса, пользователи должны все равно иметь возможность просматривать превью фотографий.
  5. НФТ - Система должна быстро загружать и отображать сниппеты постов и превью фотографий даже при медленном интернет-соединении
  6. НФТ - Система должна отображать превью фотографий даже в случае недоступности внешних ресурсов


## Структура
* discovery-service - Сервис Eureka, где "регистрируются" все запущенные микросервисы
* config-service - Сервис откуда все микросервисы подтягивают настройки
* [authentication-service](https://github.com/A192747/Social-network-with-photos/blob/main/authentication-service/authentication-service-documentation.yaml) - Сервис аунтификации пользователя (передает данные о пользователе в user-service для регистрации/записи в бд), создает accessToken и refreshToken для пользователя
* user-service - Сервис для сохранения пользователей в бд; логин пользователя (сопоставление хэша пароля с захэшированным паролем в бд)
* [snippet-service](https://github.com/A192747/Social-network-with-photos/blob/main/snippet-service/snippets-service-documentation.yaml) - Сервис подгрузки сниппета в бд
* [post-upload-service](https://github.com/A192747/Social-network-with-photos/blob/main/post-upload-service/post-upload-service-documentation.yaml) - Сервис загрузки поста в бд
* [photo-upload-service](https://github.com/A192747/Social-network-with-photos/blob/main/photo-upload-service/photo-upload-service-documentation.yaml) - Сервис загрузки фото из поста в бд и из неё, определяет средний цвет фото и сохраняет его в бд постов, чтобы было превью
* [friend-service](https://github.com/A192747/Social-network-with-photos/blob/main/friend-service/friend-service-documentation.yaml) - Сервис по подписке и отписке от пользователей. Создает связи между пользователями в графовой бд (Neo4j)
* gateway-service - Api gateway, через который проходят все запросы. При этом проверяется accessToken на валидность и, чтобы в дальнейшем каждому из микросервисов не нужно было парсить токен заново, добавляет необходимые поля (name и role) к запросу


## Модель C4

### Context
![Screenshot](https://github.com/A192747/Social-network-with-photos/blob/main/images/C4-Model/ContextC4.jpg)
### Containers
![Screenshot](https://github.com/A192747/Social-network-with-photos/blob/main/images/C4-Model/ContainersC4.jpg)
### Components
![Screenshot](https://github.com/A192747/Social-network-with-photos/blob/main/images/C4-Model/ComponentsС4.jpg)


## Unit тесты
Unit тесты реализованы в сервисах: friend-service и photo-upload-service

## Аутентификация пользователя (т.е. для доступа к сервису необходимо сперва залогиниться)

Для регистрации:
```http request
POST http://localhost:8765/auth/register
```

Для логина:
```http request
POST http://localhost:8765/auth/login
```

Тело запроса в обоих случаях:<br/>

``` json
{
    "password": "password",
    "name": "name"
}
```

В ответ пользователь получает <br/>

``` json
{
    "accessToken": "данные1",
    "refreshToken": "данные2"
}
```

В дальнейшем пользователю нужно в Headers POST запроса отправлять свой access token <br/>

```http request
POST http://localhost:8765/*
Headers: 
"key":"Authorization"
"value":"данные1"
```

При отсутствии Headers "key":"Authorization", "value":"данные1"
будет возвращаться ошибка 401 






